---
title: "Assignment3"
author: "ZOU, Huiting"
date: '2023-07-26'
output:
  pdf_document: default
  html_document: default
editor_options:
  markdown:
    wrap: sentence
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Question1

I use the dataset (`Poe and Tate APSR 1994.dta`), and set the model as this: 
$$
 pcgnp = \beta_1 left + \beta_2 lpop + \beta_3  iwar + \beta_4 cwar + \beta_5 vanhdemo +\alpha + \epsilon
$$ 


where the $psgnp$ is the corrected GNP per capita, 
and $left$ is the Leftist Regime Dummy, 
$lpop$ stands for the Population logged, 
$iwar$ is International War Dummy, while $iwar$ is the Civil War Dummy.
$vanhdemo$ is the Vanhanen Democratization Score.

## Question 2

Firstly, the pooled model goes as follows:

```{r pooled ols}
# drop all the missing values and then generate a balanced panal dataset
library(foreign)
Pta <- read.dta('Poe and Tate APSR 1994.dta')
Pta_complete <- Pta[!is.na(Pta$pcgnp) & !is.na(Pta$lpop)
                           & !is.na(Pta$iwar)& !is.na(Pta$cwar) & !is.na(Pta$britinfl)&!is.na(Pta$vanhdemo) , ]
reg.pool.Pta<- lm(pcgnp ~ left + iwar + lpop + cwar + vanhdemo, data = Pta_complete)
summary(reg.pool.Pta)

```

The regression results show that only the coefficients of $left$, $lpop$, $cwar$ and $vanhdemo$ are significant at 5% significance level.

While the estimates indicate that an increase on 1 unit higher vanhanen democratization score, lead to an increase of approximately 0.19876 units in the dependent variable $pcgnp$(GNP per capita).
And compared to countries without a civil war, the countries tend to have 2.13454 units lower in the GNP per capita.
Moreover, countries governed by a leftist regime, tend to have 0.69468 units higher in the GNP per capita, compared to countries without a control of leftist regime.
The coefficient of $lpop$ indicates that a 1% increase in population is associated with an average decrease of 0.17/100 units in GNP per capita.

The regression results also show countries with a international war tend to have higher GNP per capita. But the coefficient of this varaible is insignificant at 5% significance level.

Them run a random intercept model:

```{r random}
# random intercept model
library(plm)
reg.re.plm.swar.Pta <- plm(pcgnp ~ left + lpop + iwar + cwar + 
                           vanhdemo, data = Pta_complete, model = "random", random.method = "swar") 
summary(reg.re.plm.swar.Pta)
```

The coefficients of $left$ $lpop$ and $vanhdemo$ are significant at 5% significance level.
The regression results indicate indicate that an increase on 1 unit higher vanhanen democratization score, lead to an increase of approximately 0.041253 units in the dependent variable $pcgnp$(GNP per capita).
The coefficient of $lpop$ indicates that a 1% increase in population is associated with an average decrease of 0.556812/100 units in GNP per capita.


The regression results also show that countries with a civil war or governed by leftist regime tend to have lower GNP per capita, while countries with a international war tend to have higher GNP per capita. But the coefficients of these varaibles are insignificant at 5% significance level.

```{r}
# compare the  difference
library(texreg)
screenreg(list(reg.pool.Pta, reg.re.plm.swar.Pta))

```

There's a lot of diffrence between the regression results generated by two different way.
While the pooled model gets a significant coefficient for both the $left$ and $cwar$ at 5% significance level, but insignificant estimates in the random intercept model.

And in the random intercepts model, the estimates of intercept is much larger, while the coeffiecnts of $vanhdemo$ is smaller, and the coeffiecnts of $pop$ is greater.


## Question 3

In a fixed intercepts model as follows,

```{r fixed}
reg.fe.plm.Pta <- plm(pcgnp ~ left + lpop + iwar + cwar + 
                           vanhdemo, data = Pta_complete, model = "within")
summary(reg.fe.plm.Pta)
```

The variable $left$ is dropped from the regression.
According to the regression results, only the coefficient of $lpop$ is significant at 0.1% significance level, while the coefficient of $vanhdemo$ is significant at 10% significance.
And the estimates of $lpop$ indicates that  a 1% increase in population is associated with an average decrease of 3.720332/100 units in GNP per capita.

The regression results also show that countries with a civil war or internaitonal war tend to have higher GNP per capita, and countries with higher vanhanen democratization score tend to have higher GNP per capita. But the coefficients of these varaibles are insignificant at 5% significance level.


## Question 4
To test the difference between RE and FE, run the Hausman test

```{r hausman}
phtest(reg.fe.plm.Pta, reg.re.plm.swar.Pta)
```

The null hypothesis is rejected, so the fixed effect model should be applied to estimate the model described in question 1.

